<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Monads for the pragmatic | Func.io</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="There are plenty of monad articles but most of them are written from the assumption that monads are a good thing but sometimes fail to explain why they are a good thing. What I want to do in this arti">
<meta property="og:type" content="article">
<meta property="og:title" content="Monads for the pragmatic">
<meta property="og:url" content="http://func.io/monads-for-the-pragmatic.html">
<meta property="og:site_name" content="Func.io">
<meta property="og:description" content="There are plenty of monad articles but most of them are written from the assumption that monads are a good thing but sometimes fail to explain why they are a good thing. What I want to do in this arti">
<meta property="og:updated_time" content="2016-11-23T23:02:25.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Monads for the pragmatic">
<meta name="twitter:description" content="There are plenty of monad articles but most of them are written from the assumption that monads are a good thing but sometimes fail to explain why they are a good thing. What I want to do in this arti">
  
    <link rel="alternate" href="/atom.xml" title="Func.io" type="application/atom+xml">
  
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" integrity="sha384-XdYbMnZ/QjLh6iI4ogqCTaIjrFk87ip+ekIjefZch0Y+PvJ8CDYtEs1ipDmPorQ+" crossorigin="anonymous">

  <link rel="stylesheet" href="/css/styles.css">
  

</head>

<body>
  

  <div class="container">
    <div class="blog-header">
</div>

    <div class="row">
        <div class="col-sm-8 blog-main">
          <article id="post-monads-for-the-pragmatic" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 class="article-title" itemprop="name">
      Monads for the pragmatic
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-author">
      <a href="/author/jose">Jose Raya</a>
    </div>
    <div class="article-datetime">
  <a href="/monads-for-the-pragmatic.html" class="article-date"><time datetime="2016-11-23T22:35:47.000Z" itemprop="datePublished">2016-11-23</time></a>
</div>

    

    
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/scala/">scala</a></li></ul>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>There are plenty of monad articles but most of them are written from the assumption that monads are a good thing but sometimes fail to explain why they are a good thing. What I want to do in this article is to give an overview of the design trade-offs behing monads.</p>
<h2 id="An-example-Promises"><a href="#An-example-Promises" class="headerlink" title="An example: Promises"></a>An example: Promises</h2><p>If you have written some Javascript in the last years, you will probably have used promises. Promises are cool because they avoid the <a href="https://en.wikipedia.org/wiki/Pyramid_of_doom_(programming" target="_blank" rel="external">callback pyramid of doom</a>) problem and are more composable than callbacks.</p>
<p>A typical use case for promises are http requests: (from <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch" target="_blank" rel="external">here</a>)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myImage = <span class="built_in">document</span>.querySelector(<span class="string">'img'</span>);</div><div class="line"></div><div class="line">fetch(<span class="string">'flowers.jpg'</span>)</div><div class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> response.blob();</div><div class="line">&#125;)</div><div class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">myBlob</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> objectURL = URL.createObjectURL(myBlob);</div><div class="line">  myImage.src = objectURL;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Promises are cool because we can chain <code>.then</code> invocations and write code that looks sequential even though the execution is asynchronous.</p>
<h2 id="What-do-promises-have-to-do-with-monads"><a href="#What-do-promises-have-to-do-with-monads" class="headerlink" title="What do promises have to do with monads?"></a>What do promises have to do with monads?</h2><p>Believe it or not, promises are a lot like monads (although I am not sure that we can properly call them monads and I don’t want to give a definition of what is and what is not a monad).</p>
<p>A <a href="https://www.haskell.org/tutorial/monads.html" target="_blank" rel="external">monad</a> has two operations: <code>bind</code> and <code>return</code>. In our example, the <code>then</code> operation would be the <code>bind</code> operation (<code>flatMap</code> in Scala) that allows us to chain calculations.</p>
<p>If we were to write the former code in Scala we would write something like this:</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> myImage = document.querySelector(<span class="symbol">'im</span>g');</div><div class="line"></div><div class="line">myImage.src = fetch(<span class="string">"flowers.jpg"</span>)</div><div class="line">.flatMap(response =&gt; &#123;</div><div class="line">  response.blob()</div><div class="line">&#125;)</div><div class="line">.map(myBlob =&gt; &#123;</div><div class="line">  <span class="type">URL</span>.createObjectURL(myBlob)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>or, with a for comprehension:</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> myImage = document.querySelector(<span class="symbol">'im</span>g');</div><div class="line">myImage.src = <span class="keyword">for</span> &#123;</div><div class="line">	response &lt;- fetch(<span class="string">"flowers.jpg"</span>)</div><div class="line">	myBlob &lt;- response.blob()</div><div class="line">&#125; <span class="keyword">yield</span> &#123;</div><div class="line">	<span class="type">URL</span>.createObjectURL(myBlob)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Did you see what I did? The scala version of the code uses a different name for the <code>bind</code> operation. Instead of <code>then</code> (that only makes sense for promises) I used a more generic name <code>flatMap</code>, and this is one of the main reasons to use monads:</p>
<blockquote>
<p>By following a convention (or implementing a common interface) monads allow generic manipulation without really understanding<br>what the monad does</p>
</blockquote>
<p>The for comprehension works for Promises, but it also works for <code>Try</code>, or <code>Option</code> or any other monad we may want to implement. </p>
<p>Another example:</p>
<p>Let’s say that we implement a function that takes a <code>Seq[Promise[T]]</code> and returns a <code>Promise[Seq[T]]</code>. If later on we want a function<br>that takes a <code>Seq[Option[T]]</code> and returns an <code>Option[Seq[T]]</code> we can reuse the same funcion only if both are monads because they have some properties in common. If we were to write an Option equivalent in javascript, we could not reuse our methods that work with promises because the <code>then</code> method is specific for promises (of course we can create an <code>Option::then</code> method but that would be a bit weird).</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://func.io/monads-for-the-pragmatic.html" data-id="ciy75jm0g000262pbt9mmspr2" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
    </footer>
  </div>
  
    
<ul id="article-nav" class="nav nav-pills nav-justified">
  
  <li role="presentation">
    <a href="/reboot.html" id="article-nav-older" class="article-nav-link-wrap">
      <i class="fa fa-chevron-left pull-left"></i>
      <span class="article-nav-link-title">Reboot</span>
    </a>
  </li>
  
  
  <li role="presentation">
    <a href="/a-type-safe-string-interpolator-for-jdbc.html" id="article-nav-newer" class="article-nav-link-wrap">
      <span class="article-nav-link-title">A type-safe string interpolator for JDBC</span>
      <i class="fa fa-chevron-right pull-right"></i>
    </a>
  </li>
  
</ul>


  
</article>




        </div>
        <div class="col-sm-3 col-sm-offset-1 blog-sidebar">
          
  <div class="sidebar-module sidebar-module-inset">
  <a href="/">
    <img src='/img/logofuncionotes.png'/>
    <h2>Funció</h2> 
  </a>
  <h4>/ˈfun’sió/</h4>
  
  
    <h5>FP from the Agilogy team</h5>
  
</div>


  


  
  <div class="sidebar-module">
    <h4>Tags</h4>
    <ul class="sidebar-module-list"><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/about/">about</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/scala/">scala</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/type-classes/">type_classes</a><span class="sidebar-module-list-count">1</span></li></ul>
  </div>



  
  <div class="sidebar-module">
    <h4>Tag Cloud</h4>
    <p class="tagcloud">
      <a href="/tags/about/" style="font-size: 10px;">about</a> <a href="/tags/scala/" style="font-size: 20px;">scala</a> <a href="/tags/type-classes/" style="font-size: 10px;">type_classes</a>
    </p>
  </div>


  
  <div class="sidebar-module">
    <h4>Archives</h4>
    <ul class="sidebar-module-list"><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/01/">January 2017</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/11/">November 2016</a><span class="sidebar-module-list-count">2</span></li></ul>
  </div>



  
  <div class="sidebar-module">
    <h4>Recents</h4>
    <ul class="sidebar-module-list">
      
        <li>
          <a href="/a-type-safe-string-interpolator-for-jdbc.html">A type-safe string interpolator for JDBC</a>
        </li>
      
        <li>
          <a href="/monads-for-the-pragmatic.html">Monads for the pragmatic</a>
        </li>
      
        <li>
          <a href="/reboot.html">Reboot</a>
        </li>
      
    </ul>
  </div>



        </div>
    </div>
  </div>
  <footer class="blog-footer">
  <div class="container">
    <div id="footer-info" class="inner">
     <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.
    </div>
  </div>
</footer>

  

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>



<script src="/js/script.js"></script>

</body>
</html>
